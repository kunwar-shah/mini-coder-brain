# Software Requirements Specification (SRS)
# Mini-CoderBrain — Universal AI Context Awareness System

**Version**: 1.0
**Date**: 2025-09-29
**Purpose**: Drop-in context awareness system for any software project using Claude Code

---

## 1. Introduction

### 1.1 Purpose
Mini-CoderBrain is a lightweight, universal AI context awareness system that transforms Claude Code from a stateless assistant into a persistent, context-aware development partner. It provides automatic project structure detection, cross-session memory persistence, and intelligent context management.

### 1.2 Scope
- **Target**: Any software project using Claude Code (all languages, all frameworks)
- **Installation**: Zero-configuration drop-in (copy `.claude/` folder + `CLAUDE.md`)
- **Compatibility**: 100% universal - adapts to any project structure
- **Dependencies**: None - works out of the box

### 1.3 Core Value Proposition
- ✅ Instant context awareness on every session start
- ✅ Automatic project structure detection
- ✅ Persistent memory across sessions
- ✅ Pre/post conversation micro-context flow
- ✅ Intelligent memory sync suggestions
- ✅ Revolutionary codebase mapping

---

## 2. System Architecture

### 2.1 Directory Structure
```
[PROJECT_ROOT]/
├── .claude/
│   ├── hooks/                              # Automation hooks
│   │   ├── session-start.sh               # Session initialization + context loading
│   │   ├── optimized-intelligent-stop.sh  # Session end + memory sync
│   │   ├── conversation-capture-user-prompt.sh  # Pre-prompt micro-context
│   │   ├── intelligent-status-notification.sh   # Smart notifications
│   │   └── project-structure-detector.sh  # Universal project detection
│   ├── memory/                            # Persistent memory bank
│   │   ├── productContext.md              # Project overview & architecture
│   │   ├── activeContext.md               # Current focus & blockers
│   │   ├── progress.md                    # Development progress tracking
│   │   ├── decisionLog.md                 # Technical decisions (ADRs)
│   │   ├── systemPatterns.md              # Coding standards & patterns
│   │   └── project-structure.json         # Auto-detected project structure
│   ├── rules/                             # Reference rules (read on demand)
│   │   ├── token-efficiency.md            # Token optimization guidelines
│   │   ├── coding-standards.md            # Code quality & best practices
│   │   └── context-management.md          # Memory bank maintenance
│   ├── commands/                          # Slash commands
│   │   ├── map-codebase.md                # Codebase mapping command
│   │   └── umb.md                         # Memory sync command
│   ├── tmp/                               # Temporary files (micro-context)
│   └── settings.json                      # Claude Code configuration
└── CLAUDE.md                              # AI controller & bootstrapping rules
```

### 2.2 Component Responsibilities

#### **Hooks** (Shell Scripts - Infrastructure Only)
1. **session-start.sh**
   - Runs project structure detection
   - Loads all memory bank files
   - Displays boot status with current context
   - Purpose: Initialize AI with full project awareness

2. **optimized-intelligent-stop.sh**
   - Counts session activity (Read/Write/Edit/Bash operations)
   - Updates activeContext.md with session summary
   - Outputs valid JSON for Claude Code compliance
   - Suggests `/umb` for high-activity sessions
   - Purpose: Auto-sync basic context on session end

3. **conversation-capture-user-prompt.sh**
   - Creates micro-context file before AI response
   - Captures current project state and user intent
   - Purpose: Pre-prompt context enhancement

4. **intelligent-status-notification.sh**
   - Monitors session activity and time
   - Provides smart notifications based on context
   - Purpose: Proactive memory sync reminders

5. **project-structure-detector.sh**
   - Detects frontend/backend/database/migration paths
   - Identifies project type (Node.js, Python, Rust, Go, PHP, etc.)
   - Creates `.claude/memory/project-structure.json`
   - Purpose: Enable universal project compatibility

#### **Memory Bank** (Markdown Files)
1. **productContext.md** - Project overview, features, tech stack, goals
2. **activeContext.md** - Current focus, recent achievements, blockers, todos
3. **progress.md** - Sprint tracking, completed/in-progress/next tasks
4. **decisionLog.md** - Technical decisions with timestamps (ADR format)
5. **systemPatterns.md** - Coding standards, architectural patterns
6. **project-structure.json** - Auto-detected project paths (generated by hook)

#### **Commands** (Markdown Files with AI Integration)
1. **map-codebase.md** - Revolutionary instant file access system
2. **umb.md** - Manual memory bank synchronization

#### **CLAUDE.md Controller**
- Defines session bootstrapping rules
- Specifies auto-loading behavior
- Documents available commands
- Sets working conventions

---

## 3. Functional Requirements

### 3.1 Automatic Context Loading (FR-01)
**Priority**: CRITICAL
**Description**: On every session start, automatically load all memory bank files and display boot status.

**Acceptance Criteria**:
- ✅ All 5 memory bank files loaded into AI working memory
- ✅ Boot status displays: current focus, blockers, recent progress, key decisions
- ✅ Works without any user prompting
- ✅ Handles missing files gracefully (prompt to create templates)

**Implementation**: session-start.sh hook + CLAUDE.md bootstrapping rules

---

### 3.2 Universal Project Detection (FR-02)
**Priority**: CRITICAL
**Description**: Automatically detect project structure and technology stack on session start.

**Acceptance Criteria**:
- ✅ Detects 10+ common project patterns (frontend, backend, migrations, etc.)
- ✅ Identifies project type from package.json, requirements.txt, Cargo.toml, go.mod, composer.json
- ✅ Creates `.claude/memory/project-structure.json` with detected paths
- ✅ Works with monorepos and complex directory structures
- ✅ Provides sensible fallback defaults if detection fails

**Detection Patterns**:
```javascript
Frontend: ["frontend", "client", "web", "app", "ui", "src", "www", "public"]
Backend: ["backend", "server", "api", "app", "src", "apps/backend"]
Database: ["database", "db", "prisma", "migrations"]
Migrations: ["migrations", "db/migrate", "database/migrations", "prisma/migrations"]
Admin: ["admin", "dashboard", "backoffice", "apps/admin"]
Customer: ["customer", "portal", "client-portal", "apps/customer"]
Landing: ["landing", "website", "www", "marketing", "apps/landing"]
Mobile: ["mobile", "app", "react-native", "flutter", "ios", "android"]
Tests: ["tests", "test", "__tests__", "spec", "cypress", "e2e"]
Docs: ["docs", "documentation", "wiki", ".github"]
```

**Project Types**:
- `javascript` - package.json with no framework indicators
- `frontend` - React, Vue, Angular, Svelte in package.json
- `node_backend` - Express, Fastify, Koa in package.json
- `python` - requirements.txt or pyproject.toml
- `rust` - Cargo.toml
- `go` - go.mod
- `php` - composer.json

**Implementation**: project-structure-detector.sh hook

---

### 3.3 Persistent Memory Across Sessions (FR-03)
**Priority**: CRITICAL
**Description**: Maintain project context, progress, and decisions across all development sessions.

**Acceptance Criteria**:
- ✅ Memory bank files persist between sessions
- ✅ Updates append with timestamps (never overwrite history)
- ✅ Session summaries automatically added to activeContext.md
- ✅ Manual sync available via `/umb` command
- ✅ AI always has access to full historical context

**Update Rules**:
- **Append-only**: Always add new entries with UTC timestamps
- **Never overwrite**: Historical context must be preserved
- **Structured format**: Follow markdown templates consistently
- **Auto-sync on session end**: optimized-intelligent-stop.sh updates activeContext.md
- **Manual sync for significant work**: `/umb "note"` for detailed updates

**Implementation**: Hook-based auto-updates + `/umb` command

---

### 3.4 Micro-Context Flow (FR-04)
**Priority**: HIGH
**Description**: Create micro-context files before AI responses to enhance context awareness.

**Acceptance Criteria**:
- ✅ Pre-prompt hook creates `.claude/tmp/micro-context.md`
- ✅ Captures current project state and user intent
- ✅ AI has access to micro-context during response generation
- ✅ Temporary files cleaned up automatically

**Implementation**: conversation-capture-user-prompt.sh hook

---

### 3.5 Intelligent Notifications (FR-05)
**Priority**: MEDIUM
**Description**: Provide smart suggestions for memory sync based on session activity.

**Acceptance Criteria**:
- ✅ Tracks session activity count (Read, Write, Edit, Bash operations)
- ✅ Suggests `/umb` after high-activity sessions (>5 operations)
- ✅ Provides context-aware notifications based on development phase
- ✅ Non-intrusive - suggestions only, never blocks workflow

**Implementation**: intelligent-status-notification.sh + optimized-intelligent-stop.sh hooks

---

### 3.6 Revolutionary Codebase Mapping (FR-06)
**Priority**: HIGH
**Description**: Enable instant file access across entire codebase without searching.

**Acceptance Criteria**:
- ✅ `/map-codebase` command loads codebase map into AI context
- ✅ One-time build (~30 seconds), instant loading thereafter
- ✅ Surgical precision file access - no more "find the file" conversations
- ✅ Supports `--rebuild` and `--recent` flags
- ✅ Works with any project size and structure

**Implementation**: map-codebase.md command

---

### 3.7 Manual Memory Sync (FR-07)
**Priority**: HIGH
**Description**: Allow manual synchronization of memory bank when significant work is completed.

**Acceptance Criteria**:
- ✅ `/umb "note"` command updates all relevant memory files
- ✅ Appends to progress.md, activeContext.md, decisionLog.md as appropriate
- ✅ Adds UTC timestamps automatically
- ✅ Provides confirmation of successful sync

**Implementation**: umb.md command

---

### 3.8 Memory Cleanup & Bloat Prevention (FR-08)
**Priority**: HIGH
**Description**: Prevent "Prompt is too long" errors by archiving old session updates and cleaning temporary files.

**Acceptance Criteria**:
- ✅ Intelligent bloat detection in stop hook (>10 session updates triggers warning)
- ✅ User notification with actionable command: `/memory-cleanup`
- ✅ Archive old session updates (keep last 5 active, archive rest)
- ✅ Deduplicate repetitive ADR entries
- ✅ Clean tmp/ files >1 hour old automatically on session start
- ✅ Clean cache/ files >7 days old automatically on session start
- ✅ All data preserved in `.claude/archive/` (never deleted)
- ✅ ~60% context token reduction after cleanup

**Cleanup Triggers**:
1. **Automatic (Lightweight)**: Session start - tmp/ and cache/ cleanup
2. **Intelligent Notification**: Stop hook detects bloat, notifies user
3. **Manual Command**: `/memory-cleanup` - user-triggered deep cleanup

**Safety Features**:
- Never deletes data - only archives
- Atomic operations (temp files + move)
- Dry-run mode available
- Rollback capability via archives

**Implementation**: memory-cleanup.sh hook + /memory-cleanup command + intelligent-status-notification.sh bloat detection

---

## 4. Non-Functional Requirements

### 4.1 Universal Compatibility (NFR-01)
**Priority**: CRITICAL
**Description**: Must work with ANY project type, language, or framework without modification.

**Requirements**:
- ✅ No hard-coded project paths or structures
- ✅ Graceful handling of unknown project types
- ✅ Fallback defaults for all detections
- ✅ Works with monorepos, microservices, and simple projects

---

### 4.2 Zero Configuration (NFR-02)
**Priority**: CRITICAL
**Description**: Must work immediately after drop-in installation with no setup required.

**Requirements**:
- ✅ All hooks executable by default
- ✅ Memory bank templates provided
- ✅ Auto-detection runs on first session start
- ✅ No user configuration needed

---

### 4.3 Performance (NFR-03)
**Priority**: HIGH
**Description**: Must not slow down development workflow.

**Requirements**:
- ✅ Session start context loading: <2 seconds
- ✅ Project detection: <1 second
- ✅ Hook execution: Non-blocking, parallel where possible
- ✅ Memory bank files: Lightweight (<100KB total)

---

### 4.4 Reliability (NFR-04)
**Priority**: CRITICAL
**Description**: Must work consistently without errors.

**Requirements**:
- ✅ All hooks output valid JSON for Claude Code compliance
- ✅ Graceful error handling - never break Claude Code functionality
- ✅ All bash scripts use `set -euo pipefail` for error detection
- ✅ File operations check existence before reading

---

### 4.5 Maintainability (NFR-05)
**Priority**: HIGH
**Description**: Must be easy to understand, modify, and extend.

**Requirements**:
- ✅ Clear comments in all shell scripts
- ✅ Well-documented markdown templates
- ✅ Structured, consistent file organization
- ✅ SRS document for reference and replication

---

## 5. Installation & Usage

### 5.1 Installation Steps
```bash
# 1. Copy Mini-CoderBrain into your project
cp -r mini-coder-brain/.claude /path/to/your/project/
cp mini-coder-brain/CLAUDE.md /path/to/your/project/

# 2. That's it! Open Claude Code in your project
# Everything works automatically
```

### 5.2 First Session
1. Claude Code detects `.claude/hooks/` and runs session-start.sh
2. Project structure is auto-detected
3. Memory bank files are loaded
4. Boot status displays current context
5. You're ready to work with full context awareness

### 5.3 Daily Workflow
- **Start session**: Auto-loads context, displays boot status
- **Work on tasks**: AI has full project awareness
- **End session**: Auto-syncs basic context to activeContext.md
- **After significant work**: Run `/umb "completed X feature"` for detailed sync

### 5.4 Key Commands
- `/map-codebase` - Enable instant file access (run once)
- `/umb "note"` - Manually sync memory bank with note

---

## 6. AI Integration Instructions

### 6.1 Using This SRS with Claude Code
When setting up Mini-CoderBrain for a new project, provide Claude with:

1. **This SRS document** - Complete system specification
2. **Target project context** - Project type, structure, tech stack
3. **Project-specific requirements** - Any custom needs or patterns

**Prompt Example**:
```
I need to set up Mini-CoderBrain for my [PROJECT_TYPE] project.

Project details:
- Name: [PROJECT_NAME]
- Tech stack: [STACK]
- Structure: [DESCRIBE_STRUCTURE]
- Special requirements: [ANY_CUSTOM_NEEDS]

Please read @SRS-MINI-CODERBRAIN.md and set up the system for this project.
Customize the memory bank templates with project-specific details.
Adapt any detection patterns if needed for this project structure.

Time budget: 30 minutes
```

### 6.2 AI Implementation Checklist
When AI implements Mini-CoderBrain from this SRS:

- [ ] Create `.claude/` directory structure
- [ ] Copy all hooks from reference implementation
- [ ] Create memory bank files with project-specific templates
- [ ] Customize productContext.md with project details
- [ ] Customize systemPatterns.md with tech stack conventions
- [ ] Create settings.json with hook configuration
- [ ] Create CLAUDE.md controller
- [ ] Test session start hook (verify context loads)
- [ ] Test project detection (verify correct paths)
- [ ] Test stop hook (verify valid JSON output)
- [ ] Verify `/map-codebase` and `/umb` commands work

---

## 7. Success Criteria

### 7.1 System is Successfully Installed When:
- ✅ Session start automatically loads all memory bank files
- ✅ Boot status displays with relevant project context
- ✅ Project structure correctly detected in project-structure.json
- ✅ No hook errors in Claude Code output
- ✅ AI responds with `[CODERBRAIN: ACTIVE]` prefix
- ✅ `/map-codebase` and `/umb` commands are available

### 7.2 System is Working Correctly When:
- ✅ Context persists across sessions (test: close and reopen)
- ✅ Session summaries append to activeContext.md automatically
- ✅ AI demonstrates awareness of project structure and history
- ✅ Memory sync suggestions appear after high-activity sessions
- ✅ All operations complete without errors or warnings

---

## 8. Troubleshooting

### 8.1 Common Issues

**Issue**: Hooks not executing
- **Cause**: Hooks not executable
- **Fix**: `chmod +x .claude/hooks/*.sh`

**Issue**: JSON validation failed on stop hook
- **Cause**: Invalid JSON output
- **Fix**: Check optimized-intelligent-stop.sh outputs only valid JSON

**Issue**: Project structure not detected
- **Cause**: Unusual project structure
- **Fix**: Manually edit project-structure.json with correct paths

**Issue**: Context not loading
- **Cause**: Memory bank files missing or corrupted
- **Fix**: Recreate from templates in this SRS

---

## 9. Extension Points

### 9.1 Adding Custom Hooks
Create new hooks in `.claude/hooks/` and register in settings.json

### 9.2 Adding Custom Commands
Create new .md files in `.claude/commands/` following Claude Code command format

### 9.3 Adding Custom Memory Files
Add new .md files in `.claude/memory/` and reference in CLAUDE.md

---

## 10. Version History

- **v1.0** (2025-09-29) - Initial release
  - Universal project detection
  - Persistent memory bank
  - Micro-context flow
  - Essential commands (map-codebase, umb)
  - 100% universal compatibility

---

**End of SRS**

**License**: Open source (use freely in any project)
**Support**: Reference full CoderBrain documentation for advanced features
**Feedback**: Report issues or suggest improvements to CoderBrain development team
